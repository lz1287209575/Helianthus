# GitHub Actions 配置说明

本文档描述了Helianthus项目中GitHub Actions的配置和使用方法。

## 工作流概览

### 1. CI/CD主流程 (`ci.yml`)
- **触发条件**: 推送到main/develop分支、PR、标签发布
- **功能**: 完整的构建、测试、代码质量检查、安全扫描、发布流程
- **运行时间**: 约15-30分钟

### 2. 快速构建 (`quick-build.yml`)
- **触发条件**: PR、推送到develop/feature分支
- **功能**: 快速验证核心组件构建和关键测试
- **运行时间**: 约10-15分钟

### 3. 代码质量检查 (`code-quality.yml`)
- **触发条件**: PR、推送到main/develop分支、定时运行
- **功能**: 静态代码分析、代码格式检查、代码规范验证
- **运行时间**: 约20-30分钟

### 4. 性能测试 (`performance.yml`)
- **触发条件**: 推送到main/develop分支、PR到main分支、定时运行
- **功能**: 性能基准测试、内存分析、性能报告生成
- **运行时间**: 约30-45分钟

### 5. 安全扫描 (`security-scan.yml`)
- **触发条件**: 推送到main/develop分支、PR、定时运行
- **功能**: 代码安全分析、内存泄漏检查、漏洞扫描
- **运行时间**: 约20-30分钟

### 6. 依赖漏洞扫描 (`dependency-scan.yml`)
- **触发条件**: 推送到main/develop分支、PR、定时运行
- **功能**: 第三方依赖安全检查、系统包更新检查
- **运行时间**: 约15-20分钟

### 7. 文档生成和部署 (`docs.yml`)
- **触发条件**: 相关文件变更、推送到main分支
- **功能**: API文档生成、用户指南生成、GitHub Pages部署
- **运行时间**: 约20-30分钟

### 8. 通知和警报 (`notifications.yml`)
- **触发条件**: 工作流完成、手动触发
- **功能**: Slack通知、邮件通知、Teams通知、日报生成
- **运行时间**: 约5-10分钟

## 自定义Actions

### 验证 (`validate/`)
- 代码验证和语法检查
- 配置文件验证
- 依赖关系验证

### 清理 (`cleanup/`)
- 临时文件清理
- 缓存清理
- 构建产物清理

### 通知 (`notify/`)
- 通知服务集成
- 状态报告生成
- 错误警报

### 文档生成 (`generate-docs/`)
- API文档生成
- 用户指南生成
- 示例文档生成

### 示例运行 (`run-examples/`)
- 示例程序执行
- 功能验证
- 性能测试

### 构建项目 (`build-project/`)
- 项目构建
- 依赖管理
- 构建配置

### 运行测试 (`run-tests/`)
- 单元测试执行
- 集成测试执行
- 测试报告生成

### Bazel设置 (`setup-bazel/`)
- Bazel环境配置
- 工具链设置
- 缓存配置

## 配置要求

### 必需的Secrets
- `SLACK_WEBHOOK_URL`: Slack通知webhook URL
- `TEAMS_WEBHOOK_URL`: Microsoft Teams通知webhook URL
- `EMAIL_SMTP_HOST`: 邮件服务器地址
- `EMAIL_SMTP_PORT`: 邮件服务器端口
- `EMAIL_USERNAME`: 邮件用户名
- `EMAIL_PASSWORD`: 邮件密码

### 环境配置
- 启用GitHub Pages
- 配置分支保护规则
- 设置PR检查要求

## 使用建议

### 开发流程
1. 创建feature分支进行开发
2. 提交代码时自动触发快速构建
3. 创建PR时自动运行完整CI流程
4. 合并到develop分支时运行代码质量检查
5. 合并到main分支时运行完整测试和发布流程

### 监控和维护
1. 定期检查工作流运行状态
2. 监控构建时间和资源使用
3. 及时处理失败的构建
4. 定期更新依赖和工具版本

### 性能优化
1. 使用缓存减少构建时间
2. 并行运行独立的作业
3. 优化测试执行顺序
4. 定期清理不必要的构建产物

## 故障排除

### 常见问题
1. **构建失败**: 检查依赖安装、编译错误、测试失败
2. **超时问题**: 增加timeout设置、优化构建步骤
3. **缓存问题**: 清理缓存、检查缓存键设置
4. **权限问题**: 检查secrets配置、权限设置

### 调试方法
1. 查看工作流日志
2. 检查artifacts输出
3. 使用debug模式运行
4. 检查环境变量和secrets

## 更新和维护

### 定期任务
- 更新GitHub Actions版本
- 检查依赖包安全更新
- 优化工作流配置
- 更新文档和说明

### 版本控制
- 所有工作流文件纳入版本控制
- 重大更改需要PR审查
- 保持向后兼容性
- 记录配置变更历史
